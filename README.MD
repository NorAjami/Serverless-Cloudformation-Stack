# Serverless CloudFormation Stack

En skalbar serverless applikation byggd med AWS CloudFormation som Infrastructure as Code (IaC). Projektet demonstrerar en komplett REST API med automatiserad datahantering utan serverhantering.

## ğŸ—ï¸ Arkitektur

```
Internet â†’ API Gateway â†’ Lambda Function â†’ DynamoDB
```

**Komponenter:**
- **API Gateway**: REST API endpoint fÃ¶r HTTP-requests
- **Lambda**: Serverless Python-funktion fÃ¶r affÃ¤rslogik
- **DynamoDB**: NoSQL-databas fÃ¶r datalagring
- **IAM Roller**: SÃ¤kra behÃ¶righeter mellan tjÃ¤nster
- **CloudFormation**: Infrastructure as Code fÃ¶r reproducerbar deployment

## ğŸš€ Funktioner

- âœ… **GET /data**: HÃ¤mta all lagrad data
- âœ… **POST /data**: Skapa ny data med automatisk timestamp
- âœ… **Skalbar**: Hanterar frÃ¥n 0 till miljontals requests automatiskt
- âœ… **SÃ¤ker**: IAM-roller med minimal behÃ¶righet
- âœ… **CORS-aktiverat**: Kan anropas frÃ¥n webbapplikationer
- âœ… **Felhantering**: Robusta felmeddelanden

## ğŸ“¦ Installation & Deployment

### FÃ¶rutsÃ¤ttningar
```bash
# AWS CLI installerat och konfigurerat
aws configure

# Verifiera att du har rÃ¤tt konto
aws sts get-caller-identity
```

### Deploy Stack
```bash
# Klona projektet
git clone https://github.com/NorAjami/Serverless-Cloudformation-Stack.git
cd Serverless-Cloudformation-Stack

# Skapa CloudFormation stack
aws cloudformation create-stack \
  --stack-name serverless-stack \
  --template-body file://serverless-stack.yaml \
  --capabilities CAPABILITY_IAM

# VÃ¤nta pÃ¥ att stacken skapas (2-3 minuter)
aws cloudformation describe-stacks \
  --stack-name serverless-stack \
  --query 'Stacks[0].StackStatus'

# HÃ¤mta API URL nÃ¤r klar
aws cloudformation describe-stacks \
  --stack-name serverless-stack \
  --query 'Stacks[0].Outputs[?OutputKey==`ApiUrl`].OutputValue' \
  --output text
```

## ğŸ§ª Testning

### HÃ¤mta data (GET)
```bash
curl https://YOUR-API-ID.execute-api.eu-west-1.amazonaws.com/prod/data
```

### Skapa data (POST)
```bash
curl -X POST https://YOUR-API-ID.execute-api.eu-west-1.amazonaws.com/prod/data \
  -H "Content-Type: application/json" \
  -d '{"id": "user123", "data": "Hello Serverless World!"}'
```

### Exempel Response
```json
{
  "message": "Data created successfully",
  "item": {
    "id": "user123",
    "data": "Hello Serverless World!",
    "timestamp": "2025-09-18T15:30:45.123456"
  }
}
```

## ğŸ”§ CloudFormation Resurser

| Resurs | Typ | Beskrivning |
|--------|-----|-------------|
| `MyDataTable` | DynamoDB::Table | Huvuddatabas med pay-per-request billing |
| `LambdaExecutionRole` | IAM::Role | SÃ¤kra behÃ¶righeter fÃ¶r Lambda |
| `DataHandlerFunction` | Lambda::Function | Python 3.11 funktion fÃ¶r datahantering |
| `ServerlessAPI` | ApiGateway::RestApi | REST API endpoint |
| `DataResource` | ApiGateway::Resource | /data route |
| `GetDataMethod` | ApiGateway::Method | GET metod |
| `PostDataMethod` | ApiGateway::Method | POST metod |
| `ApiDeployment` | ApiGateway::Deployment | Publicerar API till prod stage |
| `LambdaApiGatewayPermission` | Lambda::Permission | TillÃ¥ter API Gateway anropa Lambda |

## ğŸ·ï¸ Outputs

Efter successful deployment fÃ¥r du:
- **TableName**: Namnet pÃ¥ DynamoDB-tabellen
- **LambdaFunctionName**: Namnet pÃ¥ Lambda-funktionen  
- **ApiUrl**: Den publika URL:en fÃ¶r ditt REST API

## ğŸ—‘ï¸ Rensa upp

```bash
# Ta bort hela stacken (sparar pengar!)
aws cloudformation delete-stack --stack-name serverless-stack

# Verifiera att den Ã¤r borttagen
aws cloudformation describe-stacks --stack-name serverless-stack 2>/dev/null || echo "Stack deleted successfully"
```

## ğŸ’° Kostnader

- **DynamoDB**: Pay-per-request (gratis fÃ¶r smÃ¥ volymer)
- **Lambda**: FÃ¶rsta 1M requests/mÃ¥nad gratis
- **API Gateway**: FÃ¶rsta 1M API calls/mÃ¥nad gratis
- **Perfekt fÃ¶r utveckling och testning!**

## ğŸ” Troubleshooting

### Stack creation failed?
```bash
# Se detaljerade fel
aws cloudformation describe-stack-events \
  --stack-name serverless-stack \
  --query 'StackEvents[?ResourceStatus==`CREATE_FAILED`]'
```

### API returnerar 500-fel?
```bash
# Kolla Lambda logs
aws logs tail /aws/lambda/ServerlessDataHandler --follow
```

### Permissions errors?
- Kontrollera att `--capabilities CAPABILITY_IAM` anvÃ¤nds
- Verifiera AWS credentials med `aws sts get-caller-identity`

## ğŸ“š LÃ¤rdomar

Detta projekt demonstrerar:
- **Infrastructure as Code** med CloudFormation
- **Serverless arkitektur** med AWS Lambda
- **REST API design** med API Gateway
- **NoSQL datamodellering** med DynamoDB
- **SÃ¤kerhet** med IAM roller och policies
- **Cost optimization** med pay-per-use modeller

## ğŸ¤ Utveckling

Projektet Ã¤r strukturerat fÃ¶r enkel vidareutveckling:
- LÃ¤gg till fler HTTP-metoder (PUT, DELETE)
- Implementera autentisering med API Keys
- LÃ¤gg till datavalidering och business logic
- Integrera med andra AWS-tjÃ¤nster

## ğŸ“ Teknisk Stack

- **Infrastructure**: AWS CloudFormation (YAML)
- **Compute**: AWS Lambda (Python 3.11)
- **Database**: AWS DynamoDB (NoSQL)
- **API**: AWS API Gateway (REST)
- **Security**: AWS IAM
- **Version Control**: Git + GitHub

---
